(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66795,e=>{"use strict";e.s(["default",()=>O],66795);var t=e.i(57421),i=e.i(83770),r=e.i(39324),n=e.i(89723),o=e.i(38494),s=e.i(65821),l=e.i(18962),a=e.i(19722),d=e.i(48227);let c=(0,d.default)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var u=e.i(53039),h=e.i(89124),p=e.i(690),b=e.i(88387);let g=(0,d.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),x=(0,d.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),y=(0,d.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var f=e.i(19848);let v=(0,d.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var m=e.i(56162),k=e.i(39560),j=e.i(79562);function w(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class P{withinTol(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.EPS;return Math.abs(e-t)<=i}withSuppressed(e){let t=this.suppressTracking;this.suppressTracking=!0;try{return e()}finally{this.suppressTracking=t}}pushOperation(e){let t=structuredClone(e);this.withSuppressed(()=>this.performOperation(t)),this.txnDepth>0?this.pendingOps.push(t):(this.undoStack.push(t),this.redoStack=[])}begin(){this.txnDepth++}commit(){if(0===this.txnDepth||(this.txnDepth--,this.txnDepth>0||0===this.pendingOps.length))return;let e=structuredClone(this.pendingOps);this.pendingOps=[],this.undoStack.push({kind:"bundle",ops:e}),this.redoStack=[]}undo(){var e;if(0===this.undoStack.length)return;let t=structuredClone(this.undoStack.pop());this.suppressTracking=!0;try{this.rollbackOperation(t)}finally{this.suppressTracking=!1}this.redoStack.push(t),this.board.update(),null==(e=this.onFeedback)||e.call(this,"")}redo(){var e;if(0===this.redoStack.length)return;let t=structuredClone(this.redoStack.pop());this.suppressTracking=!0;try{this.performOperation(t)}finally{this.suppressTracking=!1}this.undoStack.push(t),this.board.update(),null==(e=this.onFeedback)||e.call(this,"")}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}clear(){this.undoStack=[],this.redoStack=[]}dispose(){this.moveStarts.clear(),this.trackingInterval&&(clearInterval(this.trackingInterval),this.trackingInterval=null)}setupGlobalPointTracking(){this.attachTrackingToAllPoints(),this.trackingInterval=setInterval(()=>{this.attachTrackingToAllPoints()},1e3)}attachTrackingToAllPoints(){for(let t of Object.values(this.board.objects)){var e;(null==t?void 0:t.elType)!=="point"||(null==(e=t.visProp)?void 0:e.fixed)||this.attachPointTracking(t)}}posOf(e){return{x:e.X(),y:e.Y(),name:e._rawName||""}}definingPointsOf(e){var t,i,r,n;return e?"segment"===e.elType||"line"===e.elType?[e.point1||e.A||(null==(t=e.points)?void 0:t[0]),e.point2||e.B||(null==(i=e.points)?void 0:i[1])].filter(Boolean):"circle"===e.elType?[e.center||(null==(r=e.points)?void 0:r[0]),e.point2||(null==(n=e.points)?void 0:n[1])].filter(Boolean):[]:[]}attachPointTracking(e){e._undoRedoBound||(e._undoRedoBound=!0,e.on("down",()=>{this.suppressTracking||this.moveStarts.set(e.id,this.posOf(e))}),e.on("up",()=>{if(this.suppressTracking)return;let t=this.moveStarts.get(e.id);if(!t)return;let i=this.posOf(e);if(!this.withinTol(t.x,i.x)||!this.withinTol(t.y,i.y)||t.name!==i.name){let r={kind:"modify",pointId:e.id,before:t,after:i};this.pushOperation(r)}this.moveStarts.delete(e.id)}))}attachShapeTracking(e){let t=null,i=[],r=()=>{if(!this.suppressTracking&&0!==(i=this.definingPointsOf(e)).length)for(let e of(t={},i))t[e.id]=this.posOf(e)},n=()=>{if(this.suppressTracking||!t||0===i.length)return;let e=[];for(let r of i){let i=t[r.id];if(!i)continue;let n=this.posOf(r);(i.x!==n.x||i.y!==n.y||i.name!==n.name)&&e.push({kind:"modify",pointId:r.id,before:i,after:n})}1===e.length&&e[0]?this.pushOperation(e[0]):e.length>1&&this.pushOperation({kind:"bundle",ops:e}),t=null,i=[]};e.on("down",r),e.on("up",n)}findPointNear(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.EPS;for(let i of Object.values(this.board.objects))if((null==i?void 0:i.elType)==="point"){let r={x:i.X(),y:i.Y()};if(Math.hypot(r.x-e.x,r.y-e.y)<=t)return i}return null}isJXGPoint(e){return!!(e&&"point"===e.elType&&"function"==typeof e.X&&"function"==typeof e.Y&&e.board===this.board)}getPointByIdOrNear(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.EPS;if(e){let t=this.board.objects[e];if((null==t?void 0:t.elType)==="point")return t}for(let e of Object.values(this.board.objects))if((null==e?void 0:e.elType)==="point"&&e.X()===t.x&&e.Y()===t.y)return e;let r=this.findPointNear(t,i);return r||null}ensurePoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{name:"",size:2,strokeColor:"#444",fillColor:"#666"},i=this.findPointNear(e);if(i)return this.attachPointTracking(i),i;try{var r;let i=this.board.create("point",[e.x,e.y],t);if(!this.isJXGPoint(i))throw Error("Invalid point");return i._rawName=null!=(r=null==t?void 0:t.name)?r:"",(null==t?void 0:t.fixed)!==void 0&&i.setAttribute({fixed:t.fixed}),(null==t?void 0:t.withLabel)!==void 0&&i.setAttribute({withLabel:t.withLabel}),this.attachPointTracking(i),i}catch(e){return console.error("Failed to create point:",e),null}}performOperation(e){"create"===e.kind?this.performCreate(e):"delete"===e.kind?this.performDelete(e):"modify"===e.kind?this.performModify(e):"bundle"===e.kind&&this.performBundle(e)}rollbackOperation(e){"create"===e.kind?this.rollbackCreate(e):"delete"===e.kind?this.rollbackDelete(e):"modify"===e.kind?this.rollbackModify(e):"bundle"===e.kind&&this.rollbackBundle(e)}performCreate(e){var t,i,r,n,o,s,l,a;if("point"===e.elType){let{x:t,y:i,attr:r}=e.payload,n=this.ensurePoint({x:t,y:i},r);if(!n)return;e._id=n.id,this.board.update();return}if("segment"===e.elType||"line"===e.elType){let{p1:o,p2:s,attr:l}=e.payload,a=this.getPointByIdOrNear(null==(t=e.pointIds)?void 0:t[0],o)||this.ensurePoint(o,l),d=this.getPointByIdOrNear(null==(i=e.pointIds)?void 0:i[1],s)||this.ensurePoint(s,l),c=this.isJXGPoint(a)&&this.isJXGPoint(d)?[a,d]:[[o.x,o.y],[s.x,s.y]];try{let t=this.board.create(e.elType,c,l);e._id=t.id;let i=t.point1||t.A||(null==(r=t.points)?void 0:r[0]),o=t.point2||t.B||(null==(n=t.points)?void 0:n[1]);this.isJXGPoint(i)&&this.isJXGPoint(o)&&(e.pointIds=[i.id,o.id],this.attachPointTracking(i),this.attachPointTracking(o)),this.attachShapeTracking(t),this.board.update()}catch(t){console.error("Failed to create ".concat(e.elType,":"),t,{parents:c})}return}if("circle"===e.elType){let{center:t,on:i,attr:r}=e.payload,n=this.getPointByIdOrNear(null==(o=e.pointIds)?void 0:o[0],t)||this.ensurePoint(t,r),d=this.getPointByIdOrNear(null==(s=e.pointIds)?void 0:s[1],i)||this.ensurePoint(i,r),c=this.isJXGPoint(n)&&this.isJXGPoint(d)?[n,d]:[[t.x,t.y],[i.x,i.y]];try{let t=this.board.create("circle",c,r);e._id=t.id;let i=t.center||(null==(l=t.points)?void 0:l[0]),n=t.point2||(null==(a=t.points)?void 0:a[1]);this.isJXGPoint(i)&&this.isJXGPoint(n)&&(e.pointIds=[i.id,n.id],this.attachPointTracking(i),this.attachPointTracking(n)),this.attachShapeTracking(t),this.board.update()}catch(e){console.error("Failed to create circle:",e,{parents:c})}return}}rollbackCreate(e){if(!e._id)return;let t=this.board.objects[e._id];if(t)try{this.board.removeObject(t)}catch(t){console.error("Failed to remove object:",t,e._id)}else this.removeByMatchingDefinition({kind:"delete",elType:e.elType,payload:e.payload,_id:e._id,pointIds:e.pointIds||[]});e.pointIds&&("segment"===e.elType||"line"===e.elType||"circle"===e.elType)&&e.pointIds.forEach(e=>{let t=this.board.objects[e];if(t&&!this.isPointUsedElsewhere(e,t))try{this.board.removeObject(t)}catch(t){console.error("Failed to remove point:",t,e)}})}performDelete(e){if(e._id){let t=this.board.objects[e._id];t&&(this.board.removeObject(t),this.board.update())}else this.removeByMatchingDefinition(e),this.board.update();e.pointIds&&("segment"===e.elType||"line"===e.elType||"circle"===e.elType)&&(e.pointIds.forEach(e=>{let t=this.board.objects[e];t&&!this.isPointUsedElsewhere(e,t)&&this.board.removeObject(t)}),this.board.update())}removeByMatchingDefinition(e){for(let s of Object.values(this.board.objects)){var t,i,r,n,o;if(s.elType!==e.elType)continue;let l=!1;if("point"===e.elType){let{x:t,y:i}=e.payload;l=Math.abs(s.X()-t)<this.EPS&&Math.abs(s.Y()-i)<this.EPS}else if("segment"===e.elType||"line"===e.elType){let{p1:r,p2:n}=e.payload,o=s.point1||s.A||(null==(t=s.points)?void 0:t[0]),a=s.point2||s.B||(null==(i=s.points)?void 0:i[1]);o&&a&&(l=Math.abs(o.X()-r.x)<this.EPS&&Math.abs(o.Y()-r.y)<this.EPS&&Math.abs(a.X()-n.x)<this.EPS&&Math.abs(a.Y()-n.y)<this.EPS)}else if("circle"===e.elType){let{center:t,on:i}=e.payload,a=s.center||s.midpoint||(null==(r=s.points)?void 0:r[0]),d=s.point2||(null==(n=s.points)?void 0:n[1]);if(a){let e=Math.abs(a.X()-t.x)<this.EPS&&Math.abs(a.Y()-t.y)<this.EPS;if(d)l=e&&Math.abs(d.X()-i.x)<this.EPS&&Math.abs(d.Y()-i.y)<this.EPS;else{let r=null!=(o="function"==typeof s.R?s.R():s.radius)?o:1,n=Math.hypot(i.x-t.x,i.y-t.y);l=e&&Math.abs(r-n)<this.EPS}}}if(l){this.board.removeObject(s);break}}}rollbackDelete(e){var t,i,r,n,o,s,l,a;if("point"===e.elType){let{x:t,y:i,attr:r}=e.payload,n=this.ensurePoint({x:t,y:i},r);if(!n)return;e._id=n.id,this.board.update();return}if("segment"===e.elType||"line"===e.elType){let{p1:o,p2:s,attr:l}=e.payload,a=this.getPointByIdOrNear(null==(t=e.pointIds)?void 0:t[0],o)||this.ensurePoint(o,l),d=this.getPointByIdOrNear(null==(i=e.pointIds)?void 0:i[1],s)||this.ensurePoint(s,l),c=this.isJXGPoint(a)&&this.isJXGPoint(d)?[a,d]:[[o.x,o.y],[s.x,s.y]];try{let t=this.board.create(e.elType,c,l);e._id=t.id;let i=t.point1||t.A||(null==(r=t.points)?void 0:r[0]),o=t.point2||t.B||(null==(n=t.points)?void 0:n[1]);this.isJXGPoint(i)&&this.isJXGPoint(o)&&(e.pointIds=[i.id,o.id]),this.attachShapeTracking(t),this.board.update()}catch(t){console.error("Failed to recreate ".concat(e.elType,":"),t,{parents:c})}return}if("circle"===e.elType){let{center:t,on:i,attr:r}=e.payload,n=this.getPointByIdOrNear(null==(o=e.pointIds)?void 0:o[0],t)||this.ensurePoint(t,r),d=this.getPointByIdOrNear(null==(s=e.pointIds)?void 0:s[1],i)||this.ensurePoint(i,r),c=this.isJXGPoint(n)&&this.isJXGPoint(d)?[n,d]:[[t.x,t.y],[i.x,i.y]];try{let t=this.board.create("circle",c,r);e._id=t.id;let i=t.center||(null==(l=t.points)?void 0:l[0]),n=t.point2||(null==(a=t.points)?void 0:a[1]);this.isJXGPoint(i)&&this.isJXGPoint(n)&&(e.pointIds=[i.id,n.id]),this.attachShapeTracking(t),this.board.update()}catch(e){console.error("Failed to recreate circle:",e,{parents:c})}return}}performModify(e){let t=this.board.objects[e.pointId];if(t){try{t.moveTo([e.after.x,e.after.y])}catch(i){t.coords.setCoordinates(r.default.COORDS_BY_USER,[e.after.x,e.after.y]),this.board.update()}this.setPointName(t,e.after.name)}}rollbackModify(e){let t=this.board.objects[e.pointId];if(t){try{t.moveTo([e.before.x,e.before.y])}catch(i){t.coords.setCoordinates(r.default.COORDS_BY_USER,[e.before.x,e.before.y]),this.board.update()}this.setPointName(t,e.before.name)}}performBundle(e){for(let t of e.ops)if(t)try{let e=structuredClone(t);this.performOperation(e),("create"===e.kind||"delete"===e.kind)&&(void 0!==e._id&&(t._id=e._id),void 0!==e.pointIds&&(t.pointIds=e.pointIds))}catch(e){console.error("Error executing bundled operation:",e,t)}this.board.update()}rollbackBundle(e){for(let t=e.ops.length-1;t>=0;t--){let i=e.ops[t];if(i)try{let e=structuredClone(i);this.rollbackOperation(e),("create"===e.kind||"delete"===e.kind)&&(void 0!==e._id&&(i._id=e._id),void 0!==e.pointIds&&(i.pointIds=e.pointIds))}catch(e){console.error("Error rolling back bundled operation:",e,i)}}this.board.update()}setPointName(e,t){let i=(t||"").trim(),r=this.toSubscript(i);e.setAttribute({name:r,withLabel:!!i}),e._rawName=i}toSubscript(e){let t={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};return e.replace(/_(\d+)/g,(e,i)=>i.split("").map(e=>{var i;return null!=(i=t[e])?i:e}).join(""))}isPointUsedElsewhere(e,t){return Object.values(this.board.objects).some(i=>{var r,n,o;return i!==t&&i.id!==e&&((null==(r=i.point1)?void 0:r.id)===e||(null==(n=i.point2)?void 0:n.id)===e||(null==(o=i.center)?void 0:o.id)===e||!!(i.points&&Array.isArray(i.points))&&i.points.some(t=>(null==t?void 0:t.id)===e))})}createPointOperation(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{name:"",size:2,strokeColor:"#444",fillColor:"#666"};return{kind:"create",elType:"point",payload:{x:e,y:t,attr:i}}}createSegmentOperation(e,t,i){return{kind:"create",elType:"segment",payload:{p1:e,p2:t,attr:i}}}createLineOperation(e,t,i){return{kind:"create",elType:"line",payload:{p1:e,p2:t,attr:i}}}createCircleOperation(e,t,i){return{kind:"create",elType:"circle",payload:{center:e,on:t,attr:i}}}createDeleteOperation(e){try{var t,i,r,n,o,s,l,a,d,c,u;let h=this.getCommonAttr(e);if("point"===e.elType)return{kind:"delete",elType:"point",payload:{x:e.X(),y:e.Y(),attr:h},_id:e.id};if("segment"===e.elType||"line"===e.elType){let r=e.point1||e.A||(null==(t=e.points)?void 0:t[0]),n=e.point2||e.B||(null==(i=e.points)?void 0:i[1]);if(!r||!n)return null;return{kind:"delete",elType:e.elType,payload:{p1:{x:r.X(),y:r.Y()},p2:{x:n.X(),y:n.Y()},attr:h},_id:e.id,pointIds:[r.id,n.id]}}if("circle"===e.elType){let t,i=e.center||e.midpoint||(null==(r=e.points)?void 0:r[0]),p=e.point2||(null==(n=e.points)?void 0:n[1]),b=i?{x:i.X(),y:i.Y()}:{x:null!=(d=null==(s=e.center)||null==(o=s.X)?void 0:o.call(s))?d:0,y:null!=(c=null==(a=e.center)||null==(l=a.Y)?void 0:l.call(a))?c:0};if(p)t={x:p.X(),y:p.Y()};else{let i=null!=(u="function"==typeof e.R?e.R():e.radius)?u:1;t={x:b.x+i,y:b.y}}return{kind:"delete",elType:"circle",payload:{center:b,on:t,attr:h},_id:e.id,pointIds:i&&p?[i.id,p.id]:[]}}}catch(e){}return null}getCommonAttr(e){var t,i,r,n,o,s,l,a,d,c,u,h,p,b,g;return{name:null!=(h=null==e?void 0:e._rawName)?h:"",withLabel:!!((null==e||null==(t=e.visProp)?void 0:t.withlabel)||(null==e||null==(i=e.visProp)?void 0:i.withLabel)),fixed:!!(null==e||null==(r=e.visProp)?void 0:r.fixed),size:null==e||null==(n=e.visProp)?void 0:n.size,strokeColor:null!=(p=null==e||null==(o=e.visProp)?void 0:o.strokecolor)?p:null==e||null==(s=e.visProp)?void 0:s.strokeColor,strokeWidth:null!=(b=null==e||null==(l=e.visProp)?void 0:l.strokewidth)?b:null==e||null==(a=e.visProp)?void 0:a.strokeWidth,fillColor:null!=(g=null==e||null==(d=e.visProp)?void 0:d.fillcolor)?g:null==e||null==(c=e.visProp)?void 0:c.fillColor,dash:null==e||null==(u=e.visProp)?void 0:u.dash}}fromBoardDeleteUnderMouse(e){let t=this.board.getAllObjectsUnderMouse(e).find(e=>{var t;return!(null==e||null==(t=e.visProp)?void 0:t.fixed)});return t?this.createDeleteOperation(t):null}createModifyOperation(e,t,i){return{kind:"modify",pointId:e,before:t,after:i}}constructor(e){w(this,"board",void 0),w(this,"undoStack",[]),w(this,"redoStack",[]),w(this,"onFeedback",void 0),w(this,"EPS",void 0),w(this,"txnDepth",0),w(this,"pendingOps",[]),w(this,"suppressTracking",!1),w(this,"moveStarts",new Map),w(this,"trackingInterval",null),this.board=e.board,this.onFeedback=e.onFeedback,this.EPS=e.EPS||.03,this.setupGlobalPointTracking()}}class T{setMode(e){if(this.mode!==e){switch(this.mode=e,this.clearAll(),e){case"none":this.applyDot(!1);break;case"major":this.createLineGrid(1,"#e5e7eb",1),this.applyDot(!1);break;case"minor":this.createLineGrid(.2,"#f3f4f6",.5),this.applyDot(!1);break;case"major-minor":this.createLineGrid(.2,"#f3f4f6",.5),this.createLineGrid(1,"#d1d5db",1),this.applyDot(!1);break;case"dot":this.applyDot(!0)}this.board.update()}}setDotStep(e){this.dotStep=Math.max(.1,e),"dot"===this.mode&&this.applyDot(!0)}sync(){"dot"===this.mode&&this.applyDot(!0)}createLineGrid(e,t,i){let r=this.board.getBoundingBox();for(let n=r[0];n<=r[2];n+=e){let e=this.board.create("line",[[n,r[1]],[n,r[3]]],{strokeColor:t,strokeWidth:i,fixed:!0,highlight:!1,layer:0,withLabel:!1,showInfobox:!1,visible:!0,trace:!1,track:!1,draggable:!1});this.gridLines.push(e)}for(let n=r[3];n<=r[1];n+=e){let e=this.board.create("line",[[r[0],n],[r[2],n]],{strokeColor:t,strokeWidth:i,fixed:!0,highlight:!1,layer:0,withLabel:!1,showInfobox:!1,visible:!0,trace:!1,track:!1,draggable:!1});this.gridLines.push(e)}}clearAll(){this.gridLines.forEach(e=>{try{this.board.removeObject(e)}catch(e){}}),this.gridLines=[]}applyDot(e){if(!e){this.container.style.backgroundImage="",this.container.style.backgroundSize="",this.container.style.backgroundPosition="";return}let t=this.dotStep*this.board.unitX,i=this.dotStep*this.board.unitY;this.container.style.backgroundImage="radial-gradient(circle, #e5e7eb 1px, transparent 1px)",this.container.style.backgroundSize="".concat(t,"px ").concat(i,"px"),this.container.style.backgroundPosition="0 0"}constructor(e,t){w(this,"board",void 0),w(this,"gridLines",void 0),w(this,"mode",void 0),w(this,"dotStep",void 0),w(this,"container",void 0),this.board=e,this.gridLines=[],this.mode="none",this.dotStep=.5,this.container=t,this.container.style.position=this.container.style.position||"relative"}}class S{init(e,t){if(!this.container)throw Error("Container element is required");if(this.board)throw Error("Board already initialized");this.board=r.default.JSXGraph.initBoard(this.container,{...this.options,...e}),this.gridManager=new T(this.board,this.container),t&&this.gridManager.setMode(t),this.setupGlobalEvents()}getBoard(){if(!this.board)throw Error("Board not initialized");return this.board}getGridManager(){if(!this.gridManager)throw Error("GridManager not initialized");return this.gridManager}setGridMode(e){var t;null==(t=this.gridManager)||t.setMode(e)}setupGlobalEvents(){if(!this.board)return}updateOptions(e){if(!this.board)throw Error("Board not initialized");this.options={...this.options,...e}}free(){if(this.board){try{r.default.JSXGraph.freeBoard(this.board)}catch(e){}this.board=null}this.gridManager=null,this.container=null}constructor(e){w(this,"board",null),w(this,"gridManager",null),w(this,"container",null),w(this,"options",void 0),this.container=e.container;let{container:t,defaultGridMode:i,...r}=e;this.options={boundingbox:[-1,8,11,-1],axis:!1,showNavigation:!1,showCopyright:!1,grid:!1,pan:{enabled:!1},zoom:!1,keepaspectratio:!0,...r},this.init(r,i)}}function N(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("none"===i)return{x:e,y:t};let n=.5;if("major"===i||"major-minor"===i?n=.25:"minor"===i?n=.1:"dot"===i&&(n=.25),r){let i=Math.round(e/n)*n,r=Math.round(t/n)*n,o=.3*n;return{x:Math.abs(e-i)<o?i:e,y:Math.abs(t-r)<o?r:t}}return{x:Math.round(e/n)*n,y:Math.round(t/n)*n}}function O(){let e=(0,i.useRef)(null),d=(0,i.useRef)(null),w=(0,i.useRef)(null),[T,O]=(0,i.useState)("mouse"),[C,M]=(0,i.useState)([]),[z,E]=(0,i.useState)(""),[I,B]=(0,i.useState)(null),[X,_]=(0,i.useState)([]),[G,A]=(0,i.useState)(!1),[L,D]=(0,i.useState)([]),[R,Y]=(0,i.useState)(!1),[J,U]=(0,i.useState)(!1),[F,K]=(0,i.useState)(!1),[W,Z]=(0,i.useState)({x:5,y:4,rotation:0,length:6}),[H,V]=(0,i.useState)({x:7,y:4,rotation:0,size:3}),[q,Q]=(0,i.useState)({x:6,y:3,rotation:0,size:3}),[$,ee]=(0,i.useState)(null),[et,ei]=(0,i.useState)(!1),[er,en]=(0,i.useState)(!1),[eo,es]=(0,i.useState)(null),[el,ea]=(0,i.useState)(!1),[ed,ec]=(0,i.useState)("major"),eu=(0,i.useRef)(T),eh=(0,i.useRef)(C),ep=(0,i.useRef)(et),eb=(0,i.useRef)(er),eg=(0,i.useRef)(ed),ex=(0,i.useRef)(null),ey=(0,i.useRef)({pt:null,wasFixed:!1}),ef=(0,i.useRef)(null);function ev(e,t){let i=e.getUsrCoordsOfMouse(t);return{x:i[0],y:i[1]}}(0,i.useEffect)(()=>{eu.current=T},[T]),(0,i.useEffect)(()=>{eh.current=C},[C]),(0,i.useEffect)(()=>{ep.current=et},[et]),(0,i.useEffect)(()=>{eb.current=er},[er]),(0,i.useEffect)(()=>{eg.current=ed},[ed]);let em=(0,i.useCallback)((e,t)=>{let i=(t||"").trim(),r=function(e){let t={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};return e.replace(/_(\d+)/g,(e,i)=>i.split("").map(e=>{var i;return null!=(i=t[e])?i:e}).join(""))}(i);e.setAttribute({name:r,withLabel:!!i}),e._rawName=i},[]);function ek(e,t,i){for(let n in e.objects){let o=e.objects[n];if("point"===o.elType&&o.id!==i){var r;if((null!=(r=o._rawName)?r:"")===t)return!0}}return!1}let ej=(0,i.useCallback)((e,t)=>{let i=N(t.x,t.y,ed,!0),r=Math.max(.05,.8*("none"===ed||"minor"===ed?.1:.25)),n=Object.values(e.objects).find(e=>{var t;if((null==e?void 0:e.elType)==="point"&&!(null==(t=e.visProp)?void 0:t.fixed)){let t={x:e.X(),y:e.Y()};return Math.hypot(t.x-i.x,t.y-i.y)<=r}return!1});if(n)return n;let o="none"!==ed,s="none"===ed?.25:"minor"===ed?.1:.25,l=e.create("point",[i.x,i.y],{name:"",size:2,strokeColor:"#444",fillColor:"#666",snapToGrid:o,snapSizeX:s,snapSizeY:s});return l._rawName="",l},[ed]);(0,i.useCallback)((e,t)=>{let i=N(t.x,t.y,ed,!0),r=Math.max(.05,.8*("none"===ed||"minor"===ed?.1:.25)),n=Object.values(e.objects).find(e=>{var t;if((null==e?void 0:e.elType)==="point"&&!(null==(t=e.visProp)?void 0:t.fixed)){let t={x:e.X(),y:e.Y()};return Math.hypot(t.x-i.x,t.y-i.y)<=r}return!1});if(n)return n;let o="none"!==ed,s="none"===ed?.25:"minor"===ed?.1:.25,l=e.create("point",[i.x,i.y],{name:"",size:2,strokeColor:"#444",fillColor:"#666",snapToGrid:o,snapSizeX:s,snapSizeY:s});return l._rawName="",l&&"object"==typeof l&&"id"in l&&_(e=>[...e,l.id]),l},[ed]);let ew=(0,i.useCallback)((e,t)=>{var i,r,n,o,s,l,a,d,c,u,h,p,b,g,x,y,f,v,m,k,j,P,T;if(ep.current||eb.current)return;let S=null==(i=t.originalEvent)?void 0:i.target;if(S&&(S.closest(".group")||S.classList.contains("group")))return;let O=ev(e,t);switch(eu.current){case"mouse":e.getAllObjectsUnderMouse(t).find(e=>"point"===e.elType&&!e.visProp.fixed)?(t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),E("Bod vybrán")):E("");break;case"point":{let t=N(O.x,O.y,eg.current,!0),i=Math.max(.05,.8*("none"===eg.current||"minor"===eg.current?.1:.25));if(Object.values(e.objects).find(e=>{var r;if((null==e?void 0:e.elType)==="point"&&!(null==(r=e.visProp)?void 0:r.fixed)){let r={x:e.X(),y:e.Y()};return Math.hypot(r.x-t.x,r.y-t.y)<=i}return!1}))E("Bod již existuje na této pozici");else{let e=null==(r=w.current)?void 0:r.createPointOperation(t.x,t.y,{name:"",size:2,strokeColor:"#444",fillColor:"#666"});e&&(null==(n=w.current)||n.pushOperation(e)),E("Bod vytvořen")}break}case"segment":{let t=eh.current[0];if(!t){null==(l=w.current)||l.begin();let t=ej(e,O);if(!t){null==(a=w.current)||a.commit();break}M([t]),E("Klikněte na druhý bod");break}let i=ej(e,O);if(!i){null==(d=w.current)||d.commit(),M([]);break}let r={x:t.X(),y:t.Y()},n={x:i.X(),y:i.Y()},u=null==(o=w.current)?void 0:o.createSegmentOperation(r,n,{strokeColor:"#2563eb",strokeWidth:2});u&&(u.pointIds=[t.id,i.id],null==(c=w.current)||c.pushOperation(u)),null==(s=w.current)||s.commit(),M([]),E("Úsečka vytvořena");break}case"line":{let t=eh.current[0];if(!t){null==(p=w.current)||p.begin();let t=ej(e,O);if(!t){null==(b=w.current)||b.commit();break}M([t]),E("Klikněte na druhý bod");break}let i=ej(e,O);if(!i){null==(g=w.current)||g.commit(),M([]);break}let r={x:t.X(),y:t.Y()},n={x:i.X(),y:i.Y()},o=null==(u=w.current)?void 0:u.createLineOperation(r,n,{strokeColor:"#059669",strokeWidth:1,dash:1});o&&(o.pointIds=[t.id,i.id],null==(x=w.current)||x.pushOperation(o)),null==(h=w.current)||h.commit(),M([]),E("Přímka vytvořena");break}case"circle":{let t=eh.current[0];if(!t){null==(v=w.current)||v.begin();let t=ej(e,O);if(!t){null==(m=w.current)||m.commit();break}M([t]),E("Klikněte na bod na kružnici");break}let i=ej(e,O);if(!i){null==(k=w.current)||k.commit(),M([]);break}let r={x:t.X(),y:t.Y()},n={x:i.X(),y:i.Y()},o=null==(y=w.current)?void 0:y.createCircleOperation(r,n,{strokeColor:"#dc2626",strokeWidth:2});o&&(o.pointIds=[t.id,i.id],null==(j=w.current)||j.pushOperation(o)),null==(f=w.current)||f.commit(),M([]),E("Kružnice vytvořena");break}case"rubber":{let i=e.getAllObjectsUnderMouse(t).find(e=>{var t;return!(null==(t=e.visProp)?void 0:t.fixed)});if(i){let t=null==(P=w.current)?void 0:P.createDeleteOperation(i);t?(null==(T=w.current)||T.pushOperation(t),E("Objekt smazán")):(e.removeObject(i),E("Objekt smazán (bez historie)"))}}}},[ej]);function eP(){var t,i;let r=null==(t=e.current)?void 0:t.getBoard();if(!r)return;let n=[];for(let e in r.objects){let t=r.objects[e];(null==t||null==(i=t.visProp)?void 0:i.fixed)||n.push(t)}n.forEach(e=>r.removeObject(e)),M([]),E(""),B(null),_([])}return(0,i.useEffect)(()=>{ex.current=ew},[ew]),(0,i.useEffect)(()=>{let e=e=>{"n"!==e.key&&"N"!==e.key||ep.current||en(e=>!e)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,i.useEffect)(()=>{if(!d.current)return;let t=new S({container:d.current,boundingbox:[-1,8,11,-1],axis:!1,showNavigation:!1,showCopyright:!1,grid:!1,pan:{enabled:!1},zoom:!1,keepaspectratio:!0});e.current=t;let i=t.getBoard();return r.default.Options.point.snapToGrid=!0,r.default.Options.point.snapSizeX=.25,r.default.Options.point.snapSizeY=.25,w.current=new P({board:i,onFeedback:E,EPS:.05}),()=>{t.free(),e.current=null,w.current=null}},[]),(0,i.useEffect)(()=>{var t;null==(t=e.current)||t.setGridMode(ed)},[ed]),(0,i.useEffect)(()=>{let e=e=>{let t=e.target;el&&!t.closest(".settings-dropdown")&&ea(!1)};if(el)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[el]),(0,i.useEffect)(()=>{var t;let i=null==(t=e.current)?void 0:t.getBoard();if(!i)return;let r=null,n=null;return r=e=>{if(ep.current)return;if(!eb.current){ex.current&&ex.current(i,e);return}let t=i.getAllObjectsUnderMouse(e).find(e=>"point"===e.elType)||null;if(!t)return;let r=!!t.visProp.fixed;t.setAttribute({fixed:!0}),ey.current={pt:t,wasFixed:r},ef.current=ev(i,e),e.originalEvent&&(e.originalEvent.stopPropagation(),e.originalEvent.preventDefault())},n=e=>{let t=ey.current;if(!t.pt)return;let r=ev(i,e),n=ef.current||r;if(.12>=Math.hypot(r.x-n.x,r.y-n.y))return void((e,t)=>{var r;let n=e._rawName||"",o=(null!=(r=window.prompt("Název bodu (např. A, B, C, A_1, A_2):",n))?r:"").trim();if(o&&ek(i,o,e.id)){let t=2;for(;ek(i,"".concat(o,"_").concat(t),e.id);)t++;o="".concat(o,"_").concat(t)}em(e,o);let s=ey.current;e.setAttribute({fixed:s.wasFixed}),(null==t?void 0:t.originalEvent)&&(t.originalEvent.stopPropagation(),t.originalEvent.preventDefault()),i.update(),o||en(!1),ey.current={pt:null,wasFixed:!1},ef.current=null})(t.pt,e);let{pt:o}=t;o.setAttribute({fixed:t.wasFixed}),ey.current={pt:null,wasFixed:!1},ef.current=null},i.on("down",r),i.on("up",n),()=>{try{r&&i.off("down",r),n&&i.off("up",n)}catch(e){}}},[er,em]),(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Obecné geometrické testování"}),(0,t.jsxs)("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-4",children:[(0,t.jsx)("p",{className:"text-gray-700",children:"Volné testovací pole pro geometrické konstrukce. Můžete používat všechny dostupné nástroje bez specifických požadavků."}),(0,t.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,t.jsxs)("button",{onClick:()=>A(!G),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[(0,t.jsx)(y,{size:14}),G?"Skrýt nápovědu":"Zobrazit nápovědu"]})})]}),G&&(0,t.jsxs)("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"Nápověda k nástrojům:"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Základní nástroje:"}),(0,t.jsxs)("ul",{className:"space-y-1",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Myš:"})," Interakce s objekty bez vytváření"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Bod:"})," Vytvoření bodu kliknutím"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Úsečka:"})," Klikněte na dva body"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Přímka:"})," Klikněte na dva body"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Kružnice:"})," Střed a bod na kružnici"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Guma:"})," Smazání objektu"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-1",children:"Fyzické nástroje:"}),(0,t.jsxs)("ul",{className:"space-y-1",children:[(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Pravítko:"})," Měření vzdáleností"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Trojúhelník:"})," Rýsování úhlů"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Úhloměr:"})," Měření úhlů"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Modrý bod:"})," Přesun nástroje"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Zelený bod:"})," Otočení nástroje"]}),(0,t.jsxs)("li",{children:["• ",(0,t.jsx)("strong",{children:"Oranžový bod:"})," Změna velikosti"]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 p-4 bg-gray-100 rounded-lg",children:[(0,t.jsxs)("button",{onClick:()=>O("mouse"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("mouse"===T?"bg-gray-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"}),(0,t.jsx)("path",{d:"M13 13l6 6"})]}),"Myš"]}),(0,t.jsxs)("button",{onClick:()=>O("point"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("point"===T?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(s.Circle,{size:18})," Bod"]}),(0,t.jsxs)("button",{onClick:()=>O("segment"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("segment"===T?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(l.Pencil,{size:18})," Úsečka"]}),(0,t.jsxs)("button",{onClick:()=>O("line"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("line"===T?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(l.Pencil,{size:18})," Přímka"]}),(0,t.jsxs)("button",{onClick:()=>O("circle"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("circle"===T?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(s.Circle,{size:18})," Kružnice"]}),(0,t.jsxs)("button",{onClick:()=>O("rubber"),className:"px-3 py-2 rounded flex items-center gap-2 ".concat("rubber"===T?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(u.Eraser,{size:18})," Guma"]}),(0,t.jsx)("button",{onClick:()=>en(e=>!e),className:"px-3 py-2 rounded flex items-center gap-2 ".concat(er?"bg-teal-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),title:"Přejmenovat bod (klikněte na bod)",children:"✎ Název bodu"}),(0,t.jsx)("div",{className:"border-l-2 border-gray-300 mx-2"}),(0,t.jsxs)("button",{onClick:function(){Y(!R),R?"ruler"===$&&ee(null):(ee("ruler"),O("mouse"))},className:"px-3 py-2 rounded flex items-center gap-2 ".concat(R?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(h.Ruler,{size:18})," Pravítko"]}),(0,t.jsxs)("button",{onClick:function(){U(!J),J?"triangle"===$&&ee(null):(ee("triangle"),O("mouse"))},className:"px-3 py-2 rounded flex items-center gap-2 ".concat(J?"bg-purple-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(p.Triangle,{size:18})," Trojúhelník"]}),(0,t.jsxs)("button",{onClick:function(){K(!F),F?"protractor"===$&&ee(null):(ee("protractor"),O("mouse"))},className:"px-3 py-2 rounded flex items-center gap-2 ".concat(F?"bg-orange-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"),children:[(0,t.jsx)(b.Gauge,{size:18})," Úhloměr"]}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsxs)("button",{onClick:function(){var e;null==(e=w.current)||e.undo()},className:"px-3 py-2 rounded bg-gray-700 text-white hover:bg-gray-800 flex items-center gap-2",children:[(0,t.jsx)(a.RotateCcw,{size:18})," Zpět"]}),(0,t.jsxs)("button",{onClick:function(){var e;null==(e=w.current)||e.redo()},className:"px-3 py-2 rounded bg-gray-700 text-white hover:bg-gray-800 flex items-center gap-2",children:[(0,t.jsx)(c,{size:18})," Znovu"]}),(0,t.jsxs)("button",{onClick:eP,className:"px-3 py-2 rounded bg-red-500 text-white hover:bg-red-600 flex items-center gap-2",children:[(0,t.jsx)(o.Trash2,{size:18})," Vymazat"]}),(0,t.jsxs)("button",{onClick:function(){var t;let i=null==(t=e.current)?void 0:t.getBoard();if(!i)return;let r={timestamp:new Date().toISOString(),objects:Object.values(i.objects).map(e=>({id:e.id,type:e.elType,name:e.name,properties:e.visProp})),createdStack:[...X]};B(r),D(e=>[...e,r]),E("Konstrukce uložena")},className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[(0,t.jsx)(n.Save,{size:18})," Uložit"]}),(0,t.jsxs)("button",{onClick:function(){if(!I)return;let e=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="construction_".concat(new Date().toISOString().split("T")[0],".json"),i.click(),URL.revokeObjectURL(t),E("Konstrukce exportována")},disabled:!I,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,t.jsx)(g,{size:18})," Export"]}),(0,t.jsxs)("label",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 cursor-pointer flex items-center gap-2",children:[(0,t.jsx)(x,{size:18})," Import",(0,t.jsx)("input",{type:"file",accept:".json",onChange:function(e){var t;let i=null==(t=e.target.files)?void 0:t[0];if(!i)return;let r=new FileReader;r.onload=e=>{try{var t;let i=JSON.parse(null==(t=e.target)?void 0:t.result);B(i),E('Konstrukce načtena - klikněte na "Načíst" pro obnovení')}catch(e){E("Chyba při načítání souboru")}},r.readAsText(i)},className:"hidden"})]}),(0,t.jsxs)("button",{onClick:function(){var t;let i=null==(t=e.current)?void 0:t.getBoard();I&&i&&(eP(),E("Konstrukce načtena"))},disabled:!I,className:"px-3 py-2 rounded bg-orange-600 text-white hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,t.jsx)(x,{size:18})," Načíst"]})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"absolute top-2 right-2 z-50 settings-dropdown",style:{zIndex:9999},children:[(0,t.jsx)("button",{onClick:()=>ea(!el),className:"p-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg shadow-lg transition-colors",title:"Nastavení mřížky",style:{zIndex:1e4},children:(0,t.jsx)(f.Settings,{size:18})}),el&&(0,t.jsxs)("div",{className:"absolute top-12 right-0 bg-white border border-gray-300 rounded-lg shadow-lg min-w-48 z-20",style:{zIndex:10001},children:[(0,t.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,t.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,t.jsx)("path",{d:"M3 3h18v18H3z"}),(0,t.jsx)("path",{d:"M9 9h6v6H9z"}),(0,t.jsx)("path",{d:"M3 9h6"}),(0,t.jsx)("path",{d:"M15 9h6"}),(0,t.jsx)("path",{d:"M3 15h6"}),(0,t.jsx)("path",{d:"M15 15h6"}),(0,t.jsx)("path",{d:"M9 3v6"}),(0,t.jsx)("path",{d:"M9 15v6"}),(0,t.jsx)("path",{d:"M15 3v6"}),(0,t.jsx)("path",{d:"M15 15v6"})]}),"Zobrazit mřížku",(0,t.jsx)(v,{size:14})]})}),(0,t.jsxs)("div",{className:"py-1",children:[(0,t.jsx)("button",{onClick:()=>{ec("none"),ea(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ".concat("none"===ed?"bg-gray-100 text-gray-900":"text-gray-700"),children:"Žádná mřížka"}),(0,t.jsx)("button",{onClick:()=>{ec("major"),ea(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ".concat("major"===ed?"bg-gray-100 text-gray-900":"text-gray-700"),children:"Hlavní mřížka"}),(0,t.jsx)("button",{onClick:()=>{ec("minor"),ea(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ".concat("minor"===ed?"bg-gray-100 text-gray-900":"text-gray-700"),children:"Vedlejší mřížka"}),(0,t.jsx)("button",{onClick:()=>{ec("major-minor"),ea(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ".concat("major-minor"===ed?"bg-gray-100 text-gray-900":"text-gray-700"),children:"Hlavní a vedlejší mřížka"}),(0,t.jsx)("button",{onClick:()=>{ec("dot"),ea(!1)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ".concat("dot"===ed?"bg-gray-100 text-gray-900":"text-gray-700"),children:"Bodová mřížka"})]})]})]}),(0,t.jsxs)("div",{ref:d,id:"jxgbox",className:"w-full border-2 border-gray-300 rounded-lg bg-white jxgbox",style:{height:500,touchAction:"none"},children:[R&&(0,t.jsx)(m.default,{x:W.x,y:W.y,rotation:W.rotation,length:W.length,onPositionChange:(e,t,i,r)=>{Z({x:e,y:t,rotation:i,length:r})},isActive:"ruler"===$,onActivate:()=>{ee("ruler"),O("mouse")},onUiBusyChange:ei}),J&&(0,t.jsx)(k.default,{x:H.x,y:H.y,rotation:H.rotation,size:H.size,type:"45-45-90",onPositionChange:(e,t,i,r)=>{V({x:e,y:t,rotation:i,size:r})},isActive:"triangle"===$,onActivate:()=>{ee("triangle"),O("mouse")},onUiBusyChange:ei}),F&&(0,t.jsx)(j.default,{x:q.x,y:q.y,rotation:q.rotation,size:q.size,onPositionChange:(e,t,i,r)=>{Q({x:e,y:t,rotation:i,size:r})},isActive:"protractor"===$,onActivate:()=>{ee("protractor"),O("mouse")},onUiBusyChange:ei})]})]}),(0,t.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 rounded-lg",children:(0,t.jsxs)("p",{className:"text-blue-700 text-sm",children:[(0,t.jsx)("strong",{children:"Nápověda:"})," Modrý bod = přesun • Zelený bod = otočení • Oranžový bod = změna velikosti"]})}),z&&(0,t.jsx)("div",{className:"mt-4 p-4 rounded-lg ".concat(z.includes("✅")?"bg-green-50 border-l-4 border-green-500":"bg-yellow-50 border-l-4 border-yellow-500"),children:(0,t.jsx)("p",{className:"text-gray-800",children:z})}),L.length>0&&(0,t.jsxs)("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Historie konstrukcí"}),(0,t.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:L.map((e,i)=>{var r;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:["Konstrukce ",i+1]}),(0,t.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:new Date(e.timestamp).toLocaleString("cs-CZ")})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[(null==(r=e.objects)?void 0:r.length)||0," objektů"]})]},i)})})]})]})})})}}]);