module.exports=[92030,a=>{"use strict";a.s(["default",()=>B],92030);var b=a.i(84787),c=a.i(40044),d=a.i(35569),e=a.i(11087),f=a.i(17957),g=a.i(14425),h=a.i(21971),i=a.i(21797),j=a.i(67653);let k=(0,j.default)("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);var l=a.i(92919),m=a.i(64803),n=a.i(3989),o=a.i(79368);let p=(0,j.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),q=(0,j.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),r=(0,j.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var s=a.i(45041);let t=(0,j.default)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var u=a.i(94825),v=a.i(17740),w=a.i(75772);class x{board;undoStack=[];redoStack=[];onFeedback;EPS;txnDepth=0;pendingOps=[];suppressTracking=!1;moveStarts=new Map;trackingInterval=null;withinTol(a,b,c=this.EPS){return Math.abs(a-b)<=c}withSuppressed(a){let b=this.suppressTracking;this.suppressTracking=!0;try{return a()}finally{this.suppressTracking=b}}constructor(a){this.board=a.board,this.onFeedback=a.onFeedback,this.EPS=a.EPS||.03,this.setupGlobalPointTracking()}pushOperation(a){let b=structuredClone(a);this.withSuppressed(()=>this.performOperation(b)),this.txnDepth>0?this.pendingOps.push(b):(this.undoStack.push(b),this.redoStack=[])}begin(){this.txnDepth++}commit(){if(0===this.txnDepth||(this.txnDepth--,this.txnDepth>0||0===this.pendingOps.length))return;let a=structuredClone(this.pendingOps);this.pendingOps=[],this.undoStack.push({kind:"bundle",ops:a}),this.redoStack=[]}undo(){if(0===this.undoStack.length)return;let a=structuredClone(this.undoStack.pop());this.suppressTracking=!0;try{this.rollbackOperation(a)}finally{this.suppressTracking=!1}this.redoStack.push(a),this.board.update(),this.onFeedback?.("")}redo(){if(0===this.redoStack.length)return;let a=structuredClone(this.redoStack.pop());this.suppressTracking=!0;try{this.performOperation(a)}finally{this.suppressTracking=!1}this.undoStack.push(a),this.board.update(),this.onFeedback?.("")}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}clear(){this.undoStack=[],this.redoStack=[]}dispose(){this.moveStarts.clear(),this.trackingInterval&&(clearInterval(this.trackingInterval),this.trackingInterval=null)}setupGlobalPointTracking(){this.attachTrackingToAllPoints(),this.trackingInterval=setInterval(()=>{this.attachTrackingToAllPoints()},1e3)}attachTrackingToAllPoints(){for(let a of Object.values(this.board.objects))a?.elType!=="point"||a.visProp?.fixed||this.attachPointTracking(a)}posOf(a){return{x:a.X(),y:a.Y(),name:a._rawName||""}}definingPointsOf(a){return a?"segment"===a.elType||"line"===a.elType?[a.point1||a.A||a.points?.[0],a.point2||a.B||a.points?.[1]].filter(Boolean):"circle"===a.elType?[a.center||a.points?.[0],a.point2||a.points?.[1]].filter(Boolean):[]:[]}attachPointTracking(a){a._undoRedoBound||(a._undoRedoBound=!0,a.on("down",()=>{this.suppressTracking||this.moveStarts.set(a.id,this.posOf(a))}),a.on("up",()=>{if(this.suppressTracking)return;let b=this.moveStarts.get(a.id);if(!b)return;let c=this.posOf(a);if(!this.withinTol(b.x,c.x)||!this.withinTol(b.y,c.y)||b.name!==c.name){let d={kind:"modify",pointId:a.id,before:b,after:c};this.pushOperation(d)}this.moveStarts.delete(a.id)}))}attachShapeTracking(a){let b=null,c=[],d=()=>{if(!this.suppressTracking&&0!==(c=this.definingPointsOf(a)).length)for(let a of(b={},c))b[a.id]=this.posOf(a)},e=()=>{if(this.suppressTracking||!b||0===c.length)return;let a=[];for(let d of c){let c=b[d.id];if(!c)continue;let e=this.posOf(d);(c.x!==e.x||c.y!==e.y||c.name!==e.name)&&a.push({kind:"modify",pointId:d.id,before:c,after:e})}1===a.length&&a[0]?this.pushOperation(a[0]):a.length>1&&this.pushOperation({kind:"bundle",ops:a}),b=null,c=[]};a.on("down",d),a.on("up",e)}findPointNear(a,b=this.EPS){for(let c of Object.values(this.board.objects))if(c?.elType==="point"){let d={x:c.X(),y:c.Y()};if(Math.hypot(d.x-a.x,d.y-a.y)<=b)return c}return null}isJXGPoint(a){return!!(a&&"point"===a.elType&&"function"==typeof a.X&&"function"==typeof a.Y&&a.board===this.board)}getPointByIdOrNear(a,b,c=this.EPS){if(a){let b=this.board.objects[a];if(b?.elType==="point")return b}for(let a of Object.values(this.board.objects))if(a?.elType==="point"&&a.X()===b.x&&a.Y()===b.y)return a;let d=this.findPointNear(b,c);return d||null}ensurePoint(a,b={name:"",size:2,strokeColor:"#444",fillColor:"#666"}){let c=this.findPointNear(a);if(c)return this.attachPointTracking(c),c;try{let c=this.board.create("point",[a.x,a.y],b);if(!this.isJXGPoint(c))throw Error("Invalid point");return c._rawName=b?.name??"",b?.fixed!==void 0&&c.setAttribute({fixed:b.fixed}),b?.withLabel!==void 0&&c.setAttribute({withLabel:b.withLabel}),this.attachPointTracking(c),c}catch(a){return console.error("Failed to create point:",a),null}}performOperation(a){"create"===a.kind?this.performCreate(a):"delete"===a.kind?this.performDelete(a):"modify"===a.kind?this.performModify(a):"bundle"===a.kind&&this.performBundle(a)}rollbackOperation(a){"create"===a.kind?this.rollbackCreate(a):"delete"===a.kind?this.rollbackDelete(a):"modify"===a.kind?this.rollbackModify(a):"bundle"===a.kind&&this.rollbackBundle(a)}performCreate(a){if("point"===a.elType){let{x:b,y:c,attr:d}=a.payload,e=this.ensurePoint({x:b,y:c},d);if(!e)return;a._id=e.id,this.board.update();return}if("segment"===a.elType||"line"===a.elType){let{p1:b,p2:c,attr:d}=a.payload,e=this.getPointByIdOrNear(a.pointIds?.[0],b)||this.ensurePoint(b,d),f=this.getPointByIdOrNear(a.pointIds?.[1],c)||this.ensurePoint(c,d),g=this.isJXGPoint(e)&&this.isJXGPoint(f)?[e,f]:[[b.x,b.y],[c.x,c.y]];try{let b=this.board.create(a.elType,g,d);a._id=b.id;let c=b.point1||b.A||b.points?.[0],e=b.point2||b.B||b.points?.[1];this.isJXGPoint(c)&&this.isJXGPoint(e)&&(a.pointIds=[c.id,e.id],this.attachPointTracking(c),this.attachPointTracking(e)),this.attachShapeTracking(b),this.board.update()}catch(b){console.error(`Failed to create ${a.elType}:`,b,{parents:g})}return}if("circle"===a.elType){let{center:b,on:c,attr:d}=a.payload,e=this.getPointByIdOrNear(a.pointIds?.[0],b)||this.ensurePoint(b,d),f=this.getPointByIdOrNear(a.pointIds?.[1],c)||this.ensurePoint(c,d),g=this.isJXGPoint(e)&&this.isJXGPoint(f)?[e,f]:[[b.x,b.y],[c.x,c.y]];try{let b=this.board.create("circle",g,d);a._id=b.id;let c=b.center||b.points?.[0],e=b.point2||b.points?.[1];this.isJXGPoint(c)&&this.isJXGPoint(e)&&(a.pointIds=[c.id,e.id],this.attachPointTracking(c),this.attachPointTracking(e)),this.attachShapeTracking(b),this.board.update()}catch(a){console.error("Failed to create circle:",a,{parents:g})}return}}rollbackCreate(a){if(!a._id)return;let b=this.board.objects[a._id];if(b)try{this.board.removeObject(b)}catch(b){console.error("Failed to remove object:",b,a._id)}else this.removeByMatchingDefinition({kind:"delete",elType:a.elType,payload:a.payload,_id:a._id,pointIds:a.pointIds||[]});a.pointIds&&("segment"===a.elType||"line"===a.elType||"circle"===a.elType)&&a.pointIds.forEach(a=>{let b=this.board.objects[a];if(b&&!this.isPointUsedElsewhere(a,b))try{this.board.removeObject(b)}catch(b){console.error("Failed to remove point:",b,a)}})}performDelete(a){if(a._id){let b=this.board.objects[a._id];b&&(this.board.removeObject(b),this.board.update())}else this.removeByMatchingDefinition(a),this.board.update();a.pointIds&&("segment"===a.elType||"line"===a.elType||"circle"===a.elType)&&(a.pointIds.forEach(a=>{let b=this.board.objects[a];b&&!this.isPointUsedElsewhere(a,b)&&this.board.removeObject(b)}),this.board.update())}removeByMatchingDefinition(a){for(let b of Object.values(this.board.objects)){if(b.elType!==a.elType)continue;let c=!1;if("point"===a.elType){let{x:d,y:e}=a.payload;c=Math.abs(b.X()-d)<this.EPS&&Math.abs(b.Y()-e)<this.EPS}else if("segment"===a.elType||"line"===a.elType){let{p1:d,p2:e}=a.payload,f=b.point1||b.A||b.points?.[0],g=b.point2||b.B||b.points?.[1];f&&g&&(c=Math.abs(f.X()-d.x)<this.EPS&&Math.abs(f.Y()-d.y)<this.EPS&&Math.abs(g.X()-e.x)<this.EPS&&Math.abs(g.Y()-e.y)<this.EPS)}else if("circle"===a.elType){let{center:d,on:e}=a.payload,f=b.center||b.midpoint||b.points?.[0],g=b.point2||b.points?.[1];if(f){let a=Math.abs(f.X()-d.x)<this.EPS&&Math.abs(f.Y()-d.y)<this.EPS;if(g)c=a&&Math.abs(g.X()-e.x)<this.EPS&&Math.abs(g.Y()-e.y)<this.EPS;else{let f=("function"==typeof b.R?b.R():b.radius)??1,g=Math.hypot(e.x-d.x,e.y-d.y);c=a&&Math.abs(f-g)<this.EPS}}}if(c){this.board.removeObject(b);break}}}rollbackDelete(a){if("point"===a.elType){let{x:b,y:c,attr:d}=a.payload,e=this.ensurePoint({x:b,y:c},d);if(!e)return;a._id=e.id,this.board.update();return}if("segment"===a.elType||"line"===a.elType){let{p1:b,p2:c,attr:d}=a.payload,e=this.getPointByIdOrNear(a.pointIds?.[0],b)||this.ensurePoint(b,d),f=this.getPointByIdOrNear(a.pointIds?.[1],c)||this.ensurePoint(c,d),g=this.isJXGPoint(e)&&this.isJXGPoint(f)?[e,f]:[[b.x,b.y],[c.x,c.y]];try{let b=this.board.create(a.elType,g,d);a._id=b.id;let c=b.point1||b.A||b.points?.[0],e=b.point2||b.B||b.points?.[1];this.isJXGPoint(c)&&this.isJXGPoint(e)&&(a.pointIds=[c.id,e.id]),this.attachShapeTracking(b),this.board.update()}catch(b){console.error(`Failed to recreate ${a.elType}:`,b,{parents:g})}return}if("circle"===a.elType){let{center:b,on:c,attr:d}=a.payload,e=this.getPointByIdOrNear(a.pointIds?.[0],b)||this.ensurePoint(b,d),f=this.getPointByIdOrNear(a.pointIds?.[1],c)||this.ensurePoint(c,d),g=this.isJXGPoint(e)&&this.isJXGPoint(f)?[e,f]:[[b.x,b.y],[c.x,c.y]];try{let b=this.board.create("circle",g,d);a._id=b.id;let c=b.center||b.points?.[0],e=b.point2||b.points?.[1];this.isJXGPoint(c)&&this.isJXGPoint(e)&&(a.pointIds=[c.id,e.id]),this.attachShapeTracking(b),this.board.update()}catch(a){console.error("Failed to recreate circle:",a,{parents:g})}return}}performModify(a){let b=this.board.objects[a.pointId];if(b){try{b.moveTo([a.after.x,a.after.y])}catch(c){b.coords.setCoordinates(d.default.COORDS_BY_USER,[a.after.x,a.after.y]),this.board.update()}this.setPointName(b,a.after.name)}}rollbackModify(a){let b=this.board.objects[a.pointId];if(b){try{b.moveTo([a.before.x,a.before.y])}catch(c){b.coords.setCoordinates(d.default.COORDS_BY_USER,[a.before.x,a.before.y]),this.board.update()}this.setPointName(b,a.before.name)}}performBundle(a){for(let b of a.ops)if(b)try{let a=structuredClone(b);this.performOperation(a),("create"===a.kind||"delete"===a.kind)&&(void 0!==a._id&&(b._id=a._id),void 0!==a.pointIds&&(b.pointIds=a.pointIds))}catch(a){console.error("Error executing bundled operation:",a,b)}this.board.update()}rollbackBundle(a){for(let b=a.ops.length-1;b>=0;b--){let c=a.ops[b];if(c)try{let a=structuredClone(c);this.rollbackOperation(a),("create"===a.kind||"delete"===a.kind)&&(void 0!==a._id&&(c._id=a._id),void 0!==a.pointIds&&(c.pointIds=a.pointIds))}catch(a){console.error("Error rolling back bundled operation:",a,c)}}this.board.update()}setPointName(a,b){let c=(b||"").trim(),d=this.toSubscript(c);a.setAttribute({name:d,withLabel:!!c}),a._rawName=c}toSubscript(a){let b={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};return a.replace(/_(\d+)/g,(a,c)=>c.split("").map(a=>b[a]??a).join(""))}isPointUsedElsewhere(a,b){return Object.values(this.board.objects).some(c=>c!==b&&c.id!==a&&(c.point1?.id===a||c.point2?.id===a||c.center?.id===a||!!(c.points&&Array.isArray(c.points))&&c.points.some(b=>b?.id===a)))}createPointOperation(a,b,c={name:"",size:2,strokeColor:"#444",fillColor:"#666"}){return{kind:"create",elType:"point",payload:{x:a,y:b,attr:c}}}createSegmentOperation(a,b,c){return{kind:"create",elType:"segment",payload:{p1:a,p2:b,attr:c}}}createLineOperation(a,b,c){return{kind:"create",elType:"line",payload:{p1:a,p2:b,attr:c}}}createCircleOperation(a,b,c){return{kind:"create",elType:"circle",payload:{center:a,on:b,attr:c}}}createDeleteOperation(a){try{let b=this.getCommonAttr(a);if("point"===a.elType)return{kind:"delete",elType:"point",payload:{x:a.X(),y:a.Y(),attr:b},_id:a.id};if("segment"===a.elType||"line"===a.elType){let c=a.point1||a.A||a.points?.[0],d=a.point2||a.B||a.points?.[1];if(!c||!d)return null;return{kind:"delete",elType:a.elType,payload:{p1:{x:c.X(),y:c.Y()},p2:{x:d.X(),y:d.Y()},attr:b},_id:a.id,pointIds:[c.id,d.id]}}if("circle"===a.elType){let c,d=a.center||a.midpoint||a.points?.[0],e=a.point2||a.points?.[1],f=d?{x:d.X(),y:d.Y()}:{x:a.center?.X?.()??0,y:a.center?.Y?.()??0};if(e)c={x:e.X(),y:e.Y()};else{let b=("function"==typeof a.R?a.R():a.radius)??1;c={x:f.x+b,y:f.y}}return{kind:"delete",elType:"circle",payload:{center:f,on:c,attr:b},_id:a.id,pointIds:d&&e?[d.id,e.id]:[]}}}catch{}return null}getCommonAttr(a){return{name:a?._rawName??"",withLabel:!!(a?.visProp?.withlabel||a?.visProp?.withLabel),fixed:!!a?.visProp?.fixed,size:a?.visProp?.size,strokeColor:a?.visProp?.strokecolor??a?.visProp?.strokeColor,strokeWidth:a?.visProp?.strokewidth??a?.visProp?.strokeWidth,fillColor:a?.visProp?.fillcolor??a?.visProp?.fillColor,dash:a?.visProp?.dash}}fromBoardDeleteUnderMouse(a){let b=this.board.getAllObjectsUnderMouse(a).find(a=>!a?.visProp?.fixed);return b?this.createDeleteOperation(b):null}createModifyOperation(a,b,c){return{kind:"modify",pointId:a,before:b,after:c}}}class y{board;gridLines;mode;dotStep;container;constructor(a,b){this.board=a,this.gridLines=[],this.mode="none",this.dotStep=.5,this.container=b,this.container.style.position=this.container.style.position||"relative"}setMode(a){if(this.mode!==a){switch(this.mode=a,this.clearAll(),a){case"none":this.applyDot(!1);break;case"major":this.createLineGrid(1,"#e5e7eb",1),this.applyDot(!1);break;case"minor":this.createLineGrid(.2,"#f3f4f6",.5),this.applyDot(!1);break;case"major-minor":this.createLineGrid(.2,"#f3f4f6",.5),this.createLineGrid(1,"#d1d5db",1),this.applyDot(!1);break;case"dot":this.applyDot(!0)}this.board.update()}}setDotStep(a){this.dotStep=Math.max(.1,a),"dot"===this.mode&&this.applyDot(!0)}sync(){"dot"===this.mode&&this.applyDot(!0)}createLineGrid(a,b,c){let d=this.board.getBoundingBox();for(let e=d[0];e<=d[2];e+=a){let a=this.board.create("line",[[e,d[1]],[e,d[3]]],{strokeColor:b,strokeWidth:c,fixed:!0,highlight:!1,layer:0,withLabel:!1,showInfobox:!1,visible:!0,trace:!1,track:!1,draggable:!1});this.gridLines.push(a)}for(let e=d[3];e<=d[1];e+=a){let a=this.board.create("line",[[d[0],e],[d[2],e]],{strokeColor:b,strokeWidth:c,fixed:!0,highlight:!1,layer:0,withLabel:!1,showInfobox:!1,visible:!0,trace:!1,track:!1,draggable:!1});this.gridLines.push(a)}}clearAll(){this.gridLines.forEach(a=>{try{this.board.removeObject(a)}catch{}}),this.gridLines=[]}applyDot(a){if(!a){this.container.style.backgroundImage="",this.container.style.backgroundSize="",this.container.style.backgroundPosition="";return}let b=this.dotStep*this.board.unitX,c=this.dotStep*this.board.unitY;this.container.style.backgroundImage="radial-gradient(circle, #e5e7eb 1px, transparent 1px)",this.container.style.backgroundSize=`${b}px ${c}px`,this.container.style.backgroundPosition="0 0"}}class z{board=null;gridManager=null;container=null;options;constructor(a){this.container=a.container;let{container:b,defaultGridMode:c,...d}=a;this.options={boundingbox:[-1,8,11,-1],axis:!1,showNavigation:!1,showCopyright:!1,grid:!1,pan:{enabled:!1},zoom:!1,keepaspectratio:!0,...d},this.init(d,c)}init(a,b){if(!this.container)throw Error("Container element is required");if(this.board)throw Error("Board already initialized");this.board=d.default.JSXGraph.initBoard(this.container,{...this.options,...a}),this.gridManager=new y(this.board,this.container),b&&this.gridManager.setMode(b),this.setupGlobalEvents()}getBoard(){if(!this.board)throw Error("Board not initialized");return this.board}getGridManager(){if(!this.gridManager)throw Error("GridManager not initialized");return this.gridManager}setGridMode(a){this.gridManager?.setMode(a)}setupGlobalEvents(){if(!this.board)return}updateOptions(a){if(!this.board)throw Error("Board not initialized");this.options={...this.options,...a}}free(){if(this.board){try{d.default.JSXGraph.freeBoard(this.board)}catch(a){}this.board=null}this.gridManager=null,this.container=null}}function A(a,b,c,d=!1){if("none"===c)return{x:a,y:b};let e=.5;if("major"===c||"major-minor"===c?e=.25:"minor"===c?e=.1:"dot"===c&&(e=.25),d){let c=Math.round(a/e)*e,d=Math.round(b/e)*e,f=.3*e;return{x:Math.abs(a-c)<f?c:a,y:Math.abs(b-d)<f?d:b}}return{x:Math.round(a/e)*e,y:Math.round(b/e)*e}}function B(){let a=(0,c.useRef)(null),j=(0,c.useRef)(null),y=(0,c.useRef)(null),[B,C]=(0,c.useState)("mouse"),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(null),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)({x:5,y:4,rotation:0,length:6}),[X,Y]=(0,c.useState)({x:7,y:4,rotation:0,size:3}),[Z,$]=(0,c.useState)({x:6,y:3,rotation:0,size:3}),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)(!1),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)(null),[ah,ai]=(0,c.useState)(!1),[aj,ak]=(0,c.useState)("major"),al=(0,c.useRef)(B),am=(0,c.useRef)(D),an=(0,c.useRef)(ab),ao=(0,c.useRef)(ad),ap=(0,c.useRef)(aj),aq=(0,c.useRef)(null),ar=(0,c.useRef)({pt:null,wasFixed:!1}),as=(0,c.useRef)(null);function at(a,b){let c=a.getUsrCoordsOfMouse(b);return{x:c[0],y:c[1]}}(0,c.useEffect)(()=>{al.current=B},[B]),(0,c.useEffect)(()=>{am.current=D},[D]),(0,c.useEffect)(()=>{an.current=ab},[ab]),(0,c.useEffect)(()=>{ao.current=ad},[ad]),(0,c.useEffect)(()=>{ap.current=aj},[aj]);let au=(0,c.useCallback)((a,b)=>{let c=(b||"").trim(),d=function(a){let b={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};return a.replace(/_(\d+)/g,(a,c)=>c.split("").map(a=>b[a]??a).join(""))}(c);a.setAttribute({name:d,withLabel:!!c}),a._rawName=c},[]);function av(a,b,c){for(let d in a.objects){let e=a.objects[d];if("point"===e.elType&&e.id!==c&&(e._rawName??"")===b)return!0}return!1}let aw=(0,c.useCallback)((a,b)=>{let c=A(b.x,b.y,aj,!0),d=Math.max(.05,.8*("none"===aj||"minor"===aj?.1:.25)),e=Object.values(a.objects).find(a=>{if(a?.elType==="point"&&!a.visProp?.fixed){let b={x:a.X(),y:a.Y()};return Math.hypot(b.x-c.x,b.y-c.y)<=d}return!1});if(e)return e;let f="none"!==aj,g="none"===aj?.25:"minor"===aj?.1:.25,h=a.create("point",[c.x,c.y],{name:"",size:2,strokeColor:"#444",fillColor:"#666",snapToGrid:f,snapSizeX:g,snapSizeY:g});return h._rawName="",h},[aj]);(0,c.useCallback)((a,b)=>{let c=A(b.x,b.y,aj,!0),d=Math.max(.05,.8*("none"===aj||"minor"===aj?.1:.25)),e=Object.values(a.objects).find(a=>{if(a?.elType==="point"&&!a.visProp?.fixed){let b={x:a.X(),y:a.Y()};return Math.hypot(b.x-c.x,b.y-c.y)<=d}return!1});if(e)return e;let f="none"!==aj,g="none"===aj?.25:"minor"===aj?.1:.25,h=a.create("point",[c.x,c.y],{name:"",size:2,strokeColor:"#444",fillColor:"#666",snapToGrid:f,snapSizeX:g,snapSizeY:g});return h._rawName="",h&&"object"==typeof h&&"id"in h&&K(a=>[...a,h.id]),h},[aj]);let ax=(0,c.useCallback)((a,b)=>{if(an.current||ao.current)return;let c=b.originalEvent?.target;if(c&&(c.closest(".group")||c.classList.contains("group")))return;let d=at(a,b);switch(al.current){case"mouse":a.getAllObjectsUnderMouse(b).find(a=>"point"===a.elType&&!a.visProp.fixed)?(b.originalEvent&&(b.originalEvent.preventDefault(),b.originalEvent.stopPropagation()),G("Bod vybrán")):G("");break;case"point":{let b=A(d.x,d.y,ap.current,!0),c=Math.max(.05,.8*("none"===ap.current||"minor"===ap.current?.1:.25));if(Object.values(a.objects).find(a=>{if(a?.elType==="point"&&!a.visProp?.fixed){let d={x:a.X(),y:a.Y()};return Math.hypot(d.x-b.x,d.y-b.y)<=c}return!1}))G("Bod již existuje na této pozici");else{let a=y.current?.createPointOperation(b.x,b.y,{name:"",size:2,strokeColor:"#444",fillColor:"#666"});a&&y.current?.pushOperation(a),G("Bod vytvořen")}break}case"segment":{let b=am.current[0];if(!b){y.current?.begin();let b=aw(a,d);if(!b){y.current?.commit();break}E([b]),G("Klikněte na druhý bod");break}let c=aw(a,d);if(!c){y.current?.commit(),E([]);break}let e={x:b.X(),y:b.Y()},f={x:c.X(),y:c.Y()},g=y.current?.createSegmentOperation(e,f,{strokeColor:"#2563eb",strokeWidth:2});g&&(g.pointIds=[b.id,c.id],y.current?.pushOperation(g)),y.current?.commit(),E([]),G("Úsečka vytvořena");break}case"line":{let b=am.current[0];if(!b){y.current?.begin();let b=aw(a,d);if(!b){y.current?.commit();break}E([b]),G("Klikněte na druhý bod");break}let c=aw(a,d);if(!c){y.current?.commit(),E([]);break}let e={x:b.X(),y:b.Y()},f={x:c.X(),y:c.Y()},g=y.current?.createLineOperation(e,f,{strokeColor:"#059669",strokeWidth:1,dash:1});g&&(g.pointIds=[b.id,c.id],y.current?.pushOperation(g)),y.current?.commit(),E([]),G("Přímka vytvořena");break}case"circle":{let b=am.current[0];if(!b){y.current?.begin();let b=aw(a,d);if(!b){y.current?.commit();break}E([b]),G("Klikněte na bod na kružnici");break}let c=aw(a,d);if(!c){y.current?.commit(),E([]);break}let e={x:b.X(),y:b.Y()},f={x:c.X(),y:c.Y()},g=y.current?.createCircleOperation(e,f,{strokeColor:"#dc2626",strokeWidth:2});g&&(g.pointIds=[b.id,c.id],y.current?.pushOperation(g)),y.current?.commit(),E([]),G("Kružnice vytvořena");break}case"rubber":{let c=a.getAllObjectsUnderMouse(b).find(a=>!a.visProp?.fixed);if(c){let b=y.current?.createDeleteOperation(c);b?(y.current?.pushOperation(b),G("Objekt smazán")):(a.removeObject(c),G("Objekt smazán (bez historie)"))}}}},[aw]);function ay(){let b=a.current?.getBoard();if(!b)return;let c=[];for(let a in b.objects){let d=b.objects[a];d?.visProp?.fixed||c.push(d)}c.forEach(a=>b.removeObject(a)),E([]),G(""),I(null),K([])}return(0,c.useEffect)(()=>{aq.current=ax},[ax]),(0,c.useEffect)(()=>{let a=a=>{"n"!==a.key&&"N"!==a.key||an.current||ae(a=>!a)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]),(0,c.useEffect)(()=>{if(!j.current)return;let b=new z({container:j.current,boundingbox:[-1,8,11,-1],axis:!1,showNavigation:!1,showCopyright:!1,grid:!1,pan:{enabled:!1},zoom:!1,keepaspectratio:!0});a.current=b;let c=b.getBoard();return d.default.Options.point.snapToGrid=!0,d.default.Options.point.snapSizeX=.25,d.default.Options.point.snapSizeY=.25,y.current=new x({board:c,onFeedback:G,EPS:.05}),()=>{b.free(),a.current=null,y.current=null}},[]),(0,c.useEffect)(()=>{a.current?.setGridMode(aj)},[aj]),(0,c.useEffect)(()=>{let a=a=>{let b=a.target;ah&&!b.closest(".settings-dropdown")&&ai(!1)};if(ah)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[ah]),(0,c.useEffect)(()=>{let b=a.current?.getBoard();if(!b)return;let c=null,d=null;return c=a=>{if(an.current)return;if(!ao.current){aq.current&&aq.current(b,a);return}let c=b.getAllObjectsUnderMouse(a).find(a=>"point"===a.elType)||null;if(!c)return;let d=!!c.visProp.fixed;c.setAttribute({fixed:!0}),ar.current={pt:c,wasFixed:d},as.current=at(b,a),a.originalEvent&&(a.originalEvent.stopPropagation(),a.originalEvent.preventDefault())},d=a=>{let c=ar.current;if(!c.pt)return;let d=at(b,a),e=as.current||d;if(.12>=Math.hypot(d.x-e.x,d.y-e.y))return void((a,c)=>{let d=a._rawName||"",e=(window.prompt("Název bodu (např. A, B, C, A_1, A_2):",d)??"").trim();if(e&&av(b,e,a.id)){let c=2;for(;av(b,`${e}_${c}`,a.id);)c++;e=`${e}_${c}`}au(a,e);let f=ar.current;a.setAttribute({fixed:f.wasFixed}),c?.originalEvent&&(c.originalEvent.stopPropagation(),c.originalEvent.preventDefault()),b.update(),e||ae(!1),ar.current={pt:null,wasFixed:!1},as.current=null})(c.pt,a);let{pt:f}=c;f.setAttribute({fixed:c.wasFixed}),ar.current={pt:null,wasFixed:!1},as.current=null},b.on("down",c),b.on("up",d),()=>{try{c&&b.off("down",c),d&&b.off("up",d)}catch{}}},[ad,au]),(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,b.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Obecné geometrické testování"}),(0,b.jsxs)("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 mb-4",children:[(0,b.jsx)("p",{className:"text-gray-700",children:"Volné testovací pole pro geometrické konstrukce. Můžete používat všechny dostupné nástroje bez specifických požadavků."}),(0,b.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,b.jsxs)("button",{onClick:()=>M(!L),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[(0,b.jsx)(r,{size:14}),L?"Skrýt nápovědu":"Zobrazit nápovědu"]})})]}),L&&(0,b.jsxs)("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mb-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"Nápověda k nástrojům:"}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-blue-700",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Základní nástroje:"}),(0,b.jsxs)("ul",{className:"space-y-1",children:[(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Myš:"})," Interakce s objekty bez vytváření"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Bod:"})," Vytvoření bodu kliknutím"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Úsečka:"})," Klikněte na dva body"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Přímka:"})," Klikněte na dva body"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Kružnice:"})," Střed a bod na kružnici"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Guma:"})," Smazání objektu"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-1",children:"Fyzické nástroje:"}),(0,b.jsxs)("ul",{className:"space-y-1",children:[(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Pravítko:"})," Měření vzdáleností"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Trojúhelník:"})," Rýsování úhlů"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Úhloměr:"})," Měření úhlů"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Modrý bod:"})," Přesun nástroje"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Zelený bod:"})," Otočení nástroje"]}),(0,b.jsxs)("li",{children:["• ",(0,b.jsx)("strong",{children:"Oranžový bod:"})," Změna velikosti"]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2 mb-4 p-4 bg-gray-100 rounded-lg",children:[(0,b.jsxs)("button",{onClick:()=>C("mouse"),className:`px-3 py-2 rounded flex items-center gap-2 ${"mouse"===B?"bg-gray-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"}),(0,b.jsx)("path",{d:"M13 13l6 6"})]}),"Myš"]}),(0,b.jsxs)("button",{onClick:()=>C("point"),className:`px-3 py-2 rounded flex items-center gap-2 ${"point"===B?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(g.Circle,{size:18})," Bod"]}),(0,b.jsxs)("button",{onClick:()=>C("segment"),className:`px-3 py-2 rounded flex items-center gap-2 ${"segment"===B?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(h.Pencil,{size:18})," Úsečka"]}),(0,b.jsxs)("button",{onClick:()=>C("line"),className:`px-3 py-2 rounded flex items-center gap-2 ${"line"===B?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(h.Pencil,{size:18})," Přímka"]}),(0,b.jsxs)("button",{onClick:()=>C("circle"),className:`px-3 py-2 rounded flex items-center gap-2 ${"circle"===B?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(g.Circle,{size:18})," Kružnice"]}),(0,b.jsxs)("button",{onClick:()=>C("rubber"),className:`px-3 py-2 rounded flex items-center gap-2 ${"rubber"===B?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(l.Eraser,{size:18})," Guma"]}),(0,b.jsx)("button",{onClick:()=>ae(a=>!a),className:`px-3 py-2 rounded flex items-center gap-2 ${ad?"bg-teal-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,title:"Přejmenovat bod (klikněte na bod)",children:"✎ Název bodu"}),(0,b.jsx)("div",{className:"border-l-2 border-gray-300 mx-2"}),(0,b.jsxs)("button",{onClick:function(){Q(!P),P?"ruler"===_&&aa(null):(aa("ruler"),C("mouse"))},className:`px-3 py-2 rounded flex items-center gap-2 ${P?"bg-yellow-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(m.Ruler,{size:18})," Pravítko"]}),(0,b.jsxs)("button",{onClick:function(){S(!R),R?"triangle"===_&&aa(null):(aa("triangle"),C("mouse"))},className:`px-3 py-2 rounded flex items-center gap-2 ${R?"bg-purple-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(n.Triangle,{size:18})," Trojúhelník"]}),(0,b.jsxs)("button",{onClick:function(){U(!T),T?"protractor"===_&&aa(null):(aa("protractor"),C("mouse"))},className:`px-3 py-2 rounded flex items-center gap-2 ${T?"bg-orange-600 text-white":"bg-white text-gray-700 hover:bg-gray-200"}`,children:[(0,b.jsx)(o.Gauge,{size:18})," Úhloměr"]}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsxs)("button",{onClick:function(){y.current?.undo()},className:"px-3 py-2 rounded bg-gray-700 text-white hover:bg-gray-800 flex items-center gap-2",children:[(0,b.jsx)(i.RotateCcw,{size:18})," Zpět"]}),(0,b.jsxs)("button",{onClick:function(){y.current?.redo()},className:"px-3 py-2 rounded bg-gray-700 text-white hover:bg-gray-800 flex items-center gap-2",children:[(0,b.jsx)(k,{size:18})," Znovu"]}),(0,b.jsxs)("button",{onClick:ay,className:"px-3 py-2 rounded bg-red-500 text-white hover:bg-red-600 flex items-center gap-2",children:[(0,b.jsx)(f.Trash2,{size:18})," Vymazat"]}),(0,b.jsxs)("button",{onClick:function(){let b=a.current?.getBoard();if(!b)return;let c={timestamp:new Date().toISOString(),objects:Object.values(b.objects).map(a=>({id:a.id,type:a.elType,name:a.name,properties:a.visProp})),createdStack:[...J]};I(c),O(a=>[...a,c]),G("Konstrukce uložena")},className:"px-3 py-2 rounded bg-green-600 text-white hover:bg-green-700 flex items-center gap-2",children:[(0,b.jsx)(e.Save,{size:18})," Uložit"]}),(0,b.jsxs)("button",{onClick:function(){if(!H)return;let a=new Blob([JSON.stringify(H,null,2)],{type:"application/json"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`construction_${new Date().toISOString().split("T")[0]}.json`,c.click(),URL.revokeObjectURL(b),G("Konstrukce exportována")},disabled:!H,className:"px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,b.jsx)(p,{size:18})," Export"]}),(0,b.jsxs)("label",{className:"px-3 py-2 rounded bg-purple-600 text-white hover:bg-purple-700 cursor-pointer flex items-center gap-2",children:[(0,b.jsx)(q,{size:18})," Import",(0,b.jsx)("input",{type:"file",accept:".json",onChange:function(a){let b=a.target.files?.[0];if(!b)return;let c=new FileReader;c.onload=a=>{try{let b=JSON.parse(a.target?.result);I(b),G('Konstrukce načtena - klikněte na "Načíst" pro obnovení')}catch(a){G("Chyba při načítání souboru")}},c.readAsText(b)},className:"hidden"})]}),(0,b.jsxs)("button",{onClick:function(){let b=a.current?.getBoard();H&&b&&(ay(),G("Konstrukce načtena"))},disabled:!H,className:"px-3 py-2 rounded bg-orange-600 text-white hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[(0,b.jsx)(q,{size:18})," Načíst"]})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsxs)("div",{className:"absolute top-2 right-2 z-50 settings-dropdown",style:{zIndex:9999},children:[(0,b.jsx)("button",{onClick:()=>ai(!ah),className:"p-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg shadow-lg transition-colors",title:"Nastavení mřížky",style:{zIndex:1e4},children:(0,b.jsx)(s.Settings,{size:18})}),ah&&(0,b.jsxs)("div",{className:"absolute top-12 right-0 bg-white border border-gray-300 rounded-lg shadow-lg min-w-48 z-20",style:{zIndex:10001},children:[(0,b.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-gray-700 font-medium",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,b.jsx)("path",{d:"M3 3h18v18H3z"}),(0,b.jsx)("path",{d:"M9 9h6v6H9z"}),(0,b.jsx)("path",{d:"M3 9h6"}),(0,b.jsx)("path",{d:"M15 9h6"}),(0,b.jsx)("path",{d:"M3 15h6"}),(0,b.jsx)("path",{d:"M15 15h6"}),(0,b.jsx)("path",{d:"M9 3v6"}),(0,b.jsx)("path",{d:"M9 15v6"}),(0,b.jsx)("path",{d:"M15 3v6"}),(0,b.jsx)("path",{d:"M15 15v6"})]}),"Zobrazit mřížku",(0,b.jsx)(t,{size:14})]})}),(0,b.jsxs)("div",{className:"py-1",children:[(0,b.jsx)("button",{onClick:()=>{ak("none"),ai(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${"none"===aj?"bg-gray-100 text-gray-900":"text-gray-700"}`,children:"Žádná mřížka"}),(0,b.jsx)("button",{onClick:()=>{ak("major"),ai(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${"major"===aj?"bg-gray-100 text-gray-900":"text-gray-700"}`,children:"Hlavní mřížka"}),(0,b.jsx)("button",{onClick:()=>{ak("minor"),ai(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${"minor"===aj?"bg-gray-100 text-gray-900":"text-gray-700"}`,children:"Vedlejší mřížka"}),(0,b.jsx)("button",{onClick:()=>{ak("major-minor"),ai(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${"major-minor"===aj?"bg-gray-100 text-gray-900":"text-gray-700"}`,children:"Hlavní a vedlejší mřížka"}),(0,b.jsx)("button",{onClick:()=>{ak("dot"),ai(!1)},className:`w-full text-left px-4 py-2 text-sm hover:bg-gray-100 ${"dot"===aj?"bg-gray-100 text-gray-900":"text-gray-700"}`,children:"Bodová mřížka"})]})]})]}),(0,b.jsxs)("div",{ref:j,id:"jxgbox",className:"w-full border-2 border-gray-300 rounded-lg bg-white jxgbox",style:{height:500,touchAction:"none"},children:[P&&(0,b.jsx)(u.default,{x:V.x,y:V.y,rotation:V.rotation,length:V.length,onPositionChange:(a,b,c,d)=>{W({x:a,y:b,rotation:c,length:d})},isActive:"ruler"===_,onActivate:()=>{aa("ruler"),C("mouse")},onUiBusyChange:ac}),R&&(0,b.jsx)(v.default,{x:X.x,y:X.y,rotation:X.rotation,size:X.size,type:"45-45-90",onPositionChange:(a,b,c,d)=>{Y({x:a,y:b,rotation:c,size:d})},isActive:"triangle"===_,onActivate:()=>{aa("triangle"),C("mouse")},onUiBusyChange:ac}),T&&(0,b.jsx)(w.default,{x:Z.x,y:Z.y,rotation:Z.rotation,size:Z.size,onPositionChange:(a,b,c,d)=>{$({x:a,y:b,rotation:c,size:d})},isActive:"protractor"===_,onActivate:()=>{aa("protractor"),C("mouse")},onUiBusyChange:ac})]})]}),(0,b.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border-l-4 border-blue-500 rounded-lg",children:(0,b.jsxs)("p",{className:"text-blue-700 text-sm",children:[(0,b.jsx)("strong",{children:"Nápověda:"})," Modrý bod = přesun • Zelený bod = otočení • Oranžový bod = změna velikosti"]})}),F&&(0,b.jsx)("div",{className:`mt-4 p-4 rounded-lg ${F.includes("✅")?"bg-green-50 border-l-4 border-green-500":"bg-yellow-50 border-l-4 border-yellow-500"}`,children:(0,b.jsx)("p",{className:"text-gray-800",children:F})}),N.length>0&&(0,b.jsxs)("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Historie konstrukcí"}),(0,b.jsx)("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:N.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Konstrukce ",c+1]}),(0,b.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:new Date(a.timestamp).toLocaleString("cs-CZ")})]}),(0,b.jsxs)("div",{className:"text-xs text-gray-500",children:[a.objects?.length||0," objektů"]})]},c))})]})]})})})}}];

//# sourceMappingURL=Documents_geometry_review_app_components_GeneralGeometryTester_tsx_acc3522d._.js.map